<html>
<head>
  <title>CGView</title>
  <!-- <script src="http://code.jquery.com/jquery&#45;1.11.1.min.js"></script> -->
  <script src="javascript/jquery-1.11.1.min.js"></script>
  <!-- Local -->
  <!-- <script src="https://d3js.org/d3.v4.min.js"></script> -->
  <script src="javascript/d3.v4.min.js"></script>
  <script src="https://d3js.org/d3-selection-multi.v0.4.min.js"></script>
  <script src='dev/Viewer.js'></script>
  <script src='dev/Viewer-Drag.js'></script>
  <script src='dev/Viewer-Zoom.js'></script>
  <script src='dev/Sequence.js'></script>
  <script src='dev/Events.js'></script>
  <script src='dev/EventMonitor.js'></script>
  <script src='dev/Canvas.js'></script>
  <script src='dev/Backbone.js'></script>
  <script src='dev/Ruler.js'></script>
  <script src='dev/IO.js'></script>
  <script src='dev/Layout.js'></script>
  <script src='dev/CGArray.js'></script>
  <script src='dev/CGRange.js'></script>
  <script src='dev/Slot.js'></script>
  <script src='dev/Track.js'></script>
  <script src='dev/Feature.js'></script>
  <script src='dev/Label.js'></script>
  <script src='dev/LabelSet.js'></script>
  <script src='dev/ArcPlot.js'></script>
  <script src='dev/Legend.js'></script>
  <script src='dev/LegendItem.js'></script>
  <script src='dev/Debug.js'></script>
  <script src='dev/Color.js'></script>
  <script src='dev/ColorPicker.js'></script>
  <script src='dev/Font.js'></script>
  <script src='dev/Rect.js'></script>
  <script src='dev/Dialog.js'></script>
  <script src='dev/Menu.js'></script>
  <script src='dev/Help.js'></script>
  <script src='dev/Utils.js'></script>

  <!-- <script src="javascript/xml2json.min.js"></script> -->
  <!-- <script src="javascript/canvas2svg.js"></script> -->
  <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0&#45;alpha.6/css/bootstrap.min.css" integrity="sha384&#45;rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous"> -->
  <link rel="stylesheet" href="stylesheets/cgview.css" />
</head>
<body>
  <div id='cgview'></div>
  <!-- <a id='download&#45;svg' href='#'>SVG</a> -->
  <a href='docs/index.html'>Docs</a>
  <a href='http://wishart.biology.ualberta.ca/cgview/xml_overview.html'>XML</a>
  <a href='http://stothard.afns.ualberta.ca/cgview_server/'>P-Server</a>
  <a href='http://localhost:3010'>J-Server</a>
  <a id='save-600' href='#'>Download-600</a>
  <a id='save-1200' href='#'>Download-1200</a>
  <a id='save-3000' href='#'>Download-3000</a>
  <div id='svg-out'></div>

  <script>
    var cgv = new CGV.Viewer('#cgview', {
      // width: 1000,
      // width: 1300,
      // height: 950,
      // debug: true
      debug: {sections: ['time', 'position']}
    });
    window.cgv = cgv;
    cgv.flash('Loading...');

    $.ajax({
      // url: 'data/cgview_1.json',
      // url: 'data/cgview_1_track.json',
      // url: 'data/cgview_1_track.json',
      // url: 'data/cgview_1_seq.json',
      // url: 'data/cgview-d957a5.json',
      url: 'JSON_FORMAT.json',
      dataType: 'json',
      success: function(json) {
        console.log('loading...')
        window.data = json;
        // cgv.load_json(json.cgview);
        cgv._io.loadJSON(json.cgview);
        console.log('done!');
        $(window).trigger('resize');
        cgv.draw();
        // var color = cgv.swatchedLegendItems(1)._swatchColor;
        // cp.setRgb({r: color.rgb.r, g: color.rgb.g, b: color.rgb.b});
        // cp.hsv = color.hsv;
        // cp.opacity = color.opacity;
        // cp.updateIndicators();
      },
      error: function(xhr, status, error) {
        console.log(status)
        console.log(error)
      }
    });

    // $('#download-svg').on('click', function() {
    //   var origCtx = cgv.canvas.ctx;
    //   var ctx = new C2S(1200, 1200);
    //   cgv.canvas.ctx = ctx;
    //   cgv.draw_full();
    //   var svg = ctx.getSerializedSvg();
    //   $('#svg-out').html(svg);
    //   cgv.canvas.ctx = origCtx;
    // });

    $('#save-600').on('click', function() { cgv._io.exportImage(600,600); return false });
    $('#save-1200').on('click', function() { cgv._io.exportImage(1200,1200); return false });
    $('#save-3000').on('click', function() { cgv._io.exportImage(3000,3000); return false });

    // Resizing
    $(window).resize(function() {
      var width = window.innerWidth - 20;
      var height = window.innerHeight - 50;
      var dimension = Math.min(width, height);
      cgv.resize(dimension, dimension);
    });

  </script>
</body>
