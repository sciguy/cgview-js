<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>CGView.js</title>
    
    
    
    
    
    <meta property="og:title" content=""/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content=""/>
    
    <meta property="og:url" content=""/>
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/jaguar.css">
    
    
    <script>
    var config = {"monospaceLinks":true,"cleverLinks":true,"default":{"outputSourceFiles":true},"applicationName":"CGView.js","disqus":"","googleAnalytics":"","openGraph":{"title":"","type":"website","image":"","site_name":"","url":""},"meta":{"title":"CGView.js","description":"","keyword":""},"linenums":false};
    </script>
    

    
</head>
<body>
<div id="wrap" class="clearfix">
    
<div class="navigation">
    <h3 class="applicationName"><a href="index.html">CGView.js</a></h3>

    <div class="search">
        <input id="search" type="text" class="form-control input-sm" placeholder="Search Documentations">
    </div>
    <ul class="list">
    
        <li class="item" data-name="ArcPlot">
            <span class="title">
                <a href="ArcPlot.html">ArcPlot</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="ArcPlot#featureSlot"><a href="ArcPlot.html#featureSlot">featureSlot</a></li>
            
                <li data-name="ArcPlot#legendItem"><a href="ArcPlot.html#legendItem">legendItem</a></li>
            
                <li data-name="ArcPlot#viewer"><a href="ArcPlot.html#viewer">viewer</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Canvas">
            <span class="title">
                <a href="Canvas.html">Canvas</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Canvas#clear"><a href="Canvas.html#clear">clear</a></li>
            
                <li data-name="Canvas#flash"><a href="Canvas.html#flash">flash</a></li>
            
                <li data-name="Canvas#maximumVisibleRadius"><a href="Canvas.html#maximumVisibleRadius">maximumVisibleRadius</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Color">
            <span class="title">
                <a href="Color.html">Color</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="Color#hsv"><a href="Color.html#hsv">hsv</a></li>
            
                <li data-name="Color#opacity"><a href="Color.html#opacity">opacity</a></li>
            
                <li data-name="Color#rgb"><a href="Color.html#rgb">rgb</a></li>
            
                <li data-name="Color#rgba"><a href="Color.html#rgba">rgba</a></li>
            
                <li data-name="Color#rgbaString"><a href="Color.html#rgbaString">rgbaString</a></li>
            
                <li data-name="Color#rgbString"><a href="Color.html#rgbString">rgbString</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Color#setColor"><a href="Color.html#setColor">setColor</a></li>
            
                <li data-name="Color#toString"><a href="Color.html#toString">toString</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="ColorPicker">
            <span class="title">
                <a href="ColorPicker.html">ColorPicker</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="ColorPicker#_configureView"><a href="ColorPicker.html#_configureView">_configureView</a></li>
            
                <li data-name="ColorPicker#alphaListener"><a href="ColorPicker.html#alphaListener">alphaListener</a></li>
            
                <li data-name="ColorPicker#dialogListener"><a href="ColorPicker.html#dialogListener">dialogListener</a></li>
            
                <li data-name="ColorPicker#doneListener"><a href="ColorPicker.html#doneListener">doneListener</a></li>
            
                <li data-name="ColorPicker#enableDragging"><a href="ColorPicker.html#enableDragging">enableDragging</a></li>
            
                <li data-name="ColorPicker#originalColorListener"><a href="ColorPicker.html#originalColorListener">originalColorListener</a></li>
            
                <li data-name="ColorPicker#pickerListener"><a href="ColorPicker.html#pickerListener">pickerListener</a></li>
            
                <li data-name="ColorPicker#slideListener"><a href="ColorPicker.html#slideListener">slideListener</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Feature">
            <span class="title">
                <a href="Feature.html">Feature</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="Feature#color"><a href="Feature.html#color">color</a></li>
            
                <li data-name="Feature#decoration"><a href="Feature.html#decoration">decoration</a></li>
            
                <li data-name="Feature#featureSlot"><a href="Feature.html#featureSlot">featureSlot</a></li>
            
                <li data-name="Feature#legendItem"><a href="Feature.html#legendItem">legendItem</a></li>
            
                <li data-name="Feature#opacity"><a href="Feature.html#opacity">opacity</a></li>
            
                <li data-name="Feature#start"><a href="Feature.html#start">start</a></li>
            
                <li data-name="Feature#stop"><a href="Feature.html#stop">stop</a></li>
            
                <li data-name="Feature#viewer"><a href="Feature.html#viewer">viewer</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="FeatureSlot">
            <span class="title">
                <a href="FeatureSlot.html">FeatureSlot</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="FeatureSlot#viewer"><a href="FeatureSlot.html#viewer">viewer</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Font">
            <span class="title">
                <a href="Font.html">Font</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="Font#css"><a href="Font.html#css">css</a></li>
            
                <li data-name="Font#family"><a href="Font.html#family">family</a></li>
            
                <li data-name="Font#height"><a href="Font.html#height">height</a></li>
            
                <li data-name="Font#size"><a href="Font.html#size">size</a></li>
            
                <li data-name="Font#string"><a href="Font.html#string">string</a></li>
            
                <li data-name="Font#style"><a href="Font.html#style">style</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Font.calculateWidths"><a href="Font.html#.calculateWidths">calculateWidths</a></li>
            
                <li data-name="Font#toString"><a href="Font.html#toString">toString</a></li>
            
                <li data-name="Font#width"><a href="Font.html#width">width</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="IO">
            <span class="title">
                <a href="IO.html">IO</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="IO#load_json"><a href="IO.html#load_json">load_json</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="LegendItem">
            <span class="title">
                <a href="LegendItem.html">LegendItem</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="LegendItem#drawSwatch"><a href="LegendItem.html#drawSwatch">drawSwatch</a></li>
            
                <li data-name="LegendItem#font"><a href="LegendItem.html#font">font</a></li>
            
                <li data-name="LegendItem#fontColor"><a href="LegendItem.html#fontColor">fontColor</a></li>
            
                <li data-name="LegendItem#legend"><a href="LegendItem.html#legend">legend</a></li>
            
                <li data-name="LegendItem#swatchColor"><a href="LegendItem.html#swatchColor">swatchColor</a></li>
            
                <li data-name="LegendItem#swatchOpacity"><a href="LegendItem.html#swatchOpacity">swatchOpacity</a></li>
            
                <li data-name="LegendItem#swatchOpacity"><a href="LegendItem.html#swatchOpacity">swatchOpacity</a></li>
            
                <li data-name="LegendItem#text"><a href="LegendItem.html#text">text</a></li>
            
                <li data-name="LegendItem#textAlignment"><a href="LegendItem.html#textAlignment">textAlignment</a></li>
            
                <li data-name="LegendItem#viewer"><a href="LegendItem.html#viewer">viewer</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Ruler">
            <span class="title">
                <a href="Ruler.html">Ruler</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Viewer">
            <span class="title">
                <a href="Viewer.html">Viewer</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="Viewer#backboneRadius"><a href="Viewer.html#backboneRadius">backboneRadius</a></li>
            
                <li data-name="Viewer#height"><a href="Viewer.html#height">height</a></li>
            
                <li data-name="Viewer#sequenceLength"><a href="Viewer.html#sequenceLength">sequenceLength</a></li>
            
                <li data-name="Viewer#width"><a href="Viewer.html#width">width</a></li>
            
                <li data-name="Viewer#zoomFactor"><a href="Viewer.html#zoomFactor">zoomFactor</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Viewer#addBp"><a href="Viewer.html#addBp">addBp</a></li>
            
                <li data-name="Viewer#arcPlots"><a href="Viewer.html#arcPlots">arcPlots</a></li>
            
                <li data-name="Viewer#clear"><a href="Viewer.html#clear">clear</a></li>
            
                <li data-name="Viewer#features"><a href="Viewer.html#features">features</a></li>
            
                <li data-name="Viewer#flash"><a href="Viewer.html#flash">flash</a></li>
            
                <li data-name="Viewer#subtractBp"><a href="Viewer.html#subtractBp">subtractBp</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
    </ul>
</div>
    <div class="main">
        <h1 class="page-title" data-filename="Viewer.js.html">Source: Viewer.js</h1>
        


    
    <section>
        <article>
            <pre class="prettyprint source "><code>var CGView = {};

CGView.version = '0.1';

if (window.CGV === undefined) window.CGV = CGView;

(function(CGV) {

  /** My main class */
  class Viewer {

    /**
     * Create a viewer
     * @param {string} container_id - The ID of the element to contain the viewer
     */
    constructor(containerId, options = {}) {
      this.containerId = containerId.replace('#', '');
      this._container = d3.select(containerId);
      // this.scale = {};
      // Get options
      this._width = CGV.defaultFor(options.width, 600);
      this._height = CGV.defaultFor(options.height, 600);
      this.canvas = new CGV.Canvas(this, this._container, {width: this._width, height: this._height});
      this.ruler = new CGV.Ruler(this);
      this.sequenceLength = CGV.defaultFor(options.sequenceLength, 1000);
      this.featureSlotSpacing = CGV.defaultFor(options.featureSlotSpacing, 1);
      this.backboneRadius = CGV.defaultFor(options.backboneRadius, 200);
      this._zoomFactor = 1;
      this.debug = CGV.defaultFor(options.debug, false);

      this._io = new CGV.IO(this);

      this.initialize_dragging();
      this.initialize_zooming();

      this._featureSlots = new CGV.CGArray();
      this._legends = new CGV.CGArray();

      d3.select(this.canvas.canvasNode).on('mousemove', () => {
        if (this.debug) {
          var pos = d3.mouse(this.canvas.canvasNode);
          var mx = this.scale.x.invert(CGV.pixel(pos[0]))
          var my = this.scale.y.invert(CGV.pixel(pos[1]))
          // console.log([mx, my]);
          // console.log(this.canvas.bpForPoint({x: mx, y: my}));
          this.debug.data.position['xy'] = Math.round(mx) + ', ' + Math.round(my);
          this.debug.data.position['bp'] = this.canvas.bpForPoint({x: mx, y: my})
        }
      });

      d3.select(this.canvas.canvasNode).on('click', () => {
        console.log('CLICK')
        var swatchedLegendItems = this.swatchedLegendItems();
        var pos = d3.mouse(this.canvas.canvasNode);
        var pt = {x: CGV.pixel(pos[0]), y: CGV.pixel(pos[1])};
        for (var i = 0, len = swatchedLegendItems.length; i &lt; len; i++) {
          if ( swatchedLegendItems[i].swatchContainsPoint(pt) ) {
            var legendItem = swatchedLegendItems[i];
            console.log('SWATCH')
            // Clear previous selections
            for (var j = 0, len = swatchedLegendItems.length; j &lt; len; j++) {
              swatchedLegendItems[j].swatchSelected = false;
            }
            if (this.colorPicker == undefined) {
              // Add element to contain picker
              var colorPickerId = this.containerId + '-color-picker';
              this._container.append('div')
                .classed('cp-color-picker', true)
                .attr('id', this.containerId + '-color-picker');
              // Create Color Picker
              this.colorPicker = new CGV.ColorPicker(colorPickerId);
              legendItem.legend.setColorPickerPosition(this.colorPicker);
            }
            var cp = this.colorPicker;
            legendItem.swatchSelected = true;
            if (!cp.visible) {
              legendItem.legend.setColorPickerPosition(cp);
            }
            cp.onChange = function(color) {
              legendItem.swatchColor = color.rgbaString;
              cgv.draw_fast();
            };
            cp.onClose = function() {
              legendItem.swatchSelected = false;
              cgv.draw_fast();
            };
            cp.setColor(legendItem._swatchColor.rgba);
            cp.open();
          }
        }

      });
      // this.full_draw();
    }

    //////////////////////////////////////////////////////////////////////////
    // STATIC CLASSS METHODS
    //////////////////////////////////////////////////////////////////////////
    static get debug_sections() {
      return ['time', 'zoom', 'position'];
    }

    //////////////////////////////////////////////////////////////////////////
    // MEMBERS
    //////////////////////////////////////////////////////////////////////////

    /**
     * @member {Number} - Get or set the width of the Viewer
     */
    get width() {
      return this._width;
    }

    set width(value) {
      // TODO: update canvas
    }

    /**
     * @member {Number} - Get or set the width of the Viewer
     */
    get height() {
      return this._height;
    }

    set height(value) {
      // TODO: update canvas
    }

    /**
     * @member {Number} - Set or get the backbone radius
     */
    set backboneRadius(radius) {
      if (radius) {
        this._backboneRadius = radius;
      } else {
        this._backboneRadius = d3.min([this.width, this.height]) * 0.4;
      }
    }

    get backboneRadius() {
      return this._backboneRadius * this._zoomFactor
    }

    /**
     * @member {Number} - Get or set the zoom level of the image
     */
    get zoomFactor() {
      return this._zoomFactor;
    }

    set zoomeFactor(value) {
      this._zoomFactor = value;
      // TODO: update anything related to zoom
    }

    get scale() {
      return this.canvas.scale
    }

    get ctx() {
      return this.canvas.ctx
    }

    /**
     * Get or set the sequence length
     */
    get sequenceLength() {
      return this._sequenceLength;
    }

    set sequenceLength(bp) {
      if (bp) {
        this._sequenceLength = Number(bp);
        this.canvas.scale.bp = d3.scaleLinear()
          .domain([1, this._sequenceLength])
          .range([-1/2*Math.PI, 3/2*Math.PI]);
      }
    }

    get debug() {
      return this._debug;
    }

    set debug(options) {
      if (options) {
        if (options === true) {
          // Select all sections
          options = {};
          options.sections = Viewer.debug_sections;
        }
        this._debug = new CGV.Debug(options);
      } else {
        this._debug = undefined;
      }
    }

    //////////////////////////////////////////////////////////////////////////
    // METHODS
    //////////////////////////////////////////////////////////////////////////

    load_json(json) {
      this._io.load_json(json);
    }

  /**
   * Returns an [CGArray](CGArray.js.html) of Features or a single Feature from all the FeatureSlots in the viewer.
   * @param {Integer|String|Array} term - See [CGArray.get](CGArray.js.html#get) for details.
   * @return {CGArray}
   */
    features(term) {
      var features = new CGV.CGArray();
      for (var i=0, len=this._featureSlots.length; i &lt; len; i++) {
        features.merge(this._featureSlots[i]._features);
      }
      return features.get(term);
    }

  /**
   * Returns an [CGArray](CGArray.js.html) of ArcPlots or a single ArcPlot from all the FeatureSlots in the viewer.
   * @param {Integer|String|Array} term - See [CGArray.get](CGArray.js.html#get) for details.
   * @return {CGArray}
   */
    arcPlots(term) {
      var plots = new CGV.CGArray();
      var arcPlot;
      for (var i=0, len=this._featureSlots.length; i &lt; len; i++) {
        arcPlot = this._featureSlots[i]._arcPlot;
        if (arcPlot) {
          plots.push(arcPlot);
        }
      }
      return plots.get(term);
    }

    swatchedLegendItems(term) {
      var items = new CGV.CGArray();
      for (var i=0, len=this._legends.length; i &lt; len; i++) {
        items.merge( this._legends[i]._legendItems.filter( (item) => {return item.drawSwatch}) );
      }
      return items.get(term);
    }

    // load_xml(xml) {
    //   this._io.load_xml(xml);
    // }

    /**
     * Clear the viewer canvas
     */
    clear() {
      this.canvas.clear();
    }

    /**
    * Flash a message on the center of the viewer.
    */
    flash(msg) {
      this.canvas.flash(msg);
    }

    draw_full() {
      this.draw();
    }

    draw_fast() {
      this.draw(true);
    }

    draw(fast) {
      var start_time = new Date().getTime();
      this.clear();
      var backboneThickness = CGV.pixel(3);
      var slotRadius = CGV.pixel(this.backboneRadius);
      var directRadius = slotRadius + (backboneThickness / 2);
      var reverseRadius = slotRadius - (backboneThickness / 2);
      var spacing = CGV.pixel(this.featureSlotSpacing);
      // var minDimension = CGV.pixel(Math.min(this.height, this.width));
      var minDimension = Math.min(this.height, this.width);
      var maxRadius = minDimension; // TODO: need to add up all proportions

      var visibleRadii = this.canvas.visibleRadii();

      // Draw Backbone
      this.canvas.drawArc(1, this.sequenceLength, slotRadius, 'black', backboneThickness);

      var residualSlotThickness = 0;

      // FetaureSlots
      for (var i = 0, len = this._featureSlots.length; i &lt; len; i++) {
        // TESTING
        // if ([0].indexOf(i) == -1) {
        //   continue
        // }

        var slot = this._featureSlots[i];
        // Calculate Slot dimensions
        // The slotRadius is the radius at the center of the slot
        var slotThickness = CGV.pixel( Math.min(this.backboneRadius, maxRadius) * slot._proportionOfRadius);
        if (slot.isDirect()) {
          directRadius += ( (slotThickness / 2) + spacing + residualSlotThickness);
          slotRadius = directRadius;
        } else {
          reverseRadius -= ( (slotThickness / 2) + spacing + residualSlotThickness);
          slotRadius = reverseRadius;
        }
        residualSlotThickness = slotThickness / 2;
        // Only draw visible slots
        if ( ( (slotRadius - residualSlotThickness) &lt;= visibleRadii.max ) &amp;&amp; ( (slotRadius + residualSlotThickness) >= visibleRadii.min) ) {
          // Draw Slot
          slot.draw(this.canvas, fast, slotRadius, slotThickness);
        }

      }

      // Ruler
      this.ruler.draw(reverseRadius, directRadius);
      if (this.debug) {
        this.debug.data.time['draw'] = CGV.elapsed_time(start_time);
        this.debug.draw(this.ctx);
      }

      // Legends
      for (var i = 0, len = this._legends.length; i &lt; len; i++) {
        this._legends[i].draw(this.ctx);
      }

    }

    // addFeatureSlot(featureSlot) {
    //   // TODO: error check that this is a featureSlot
    //   this._featureSlots.push(featureSlot);
    //   featureSlot._viewer = this;
    // }

    /**
     * Subtract *bpToSubtract* from *position*, taking into account the sequenceLength
     * @param {Number} position - position (in bp) to subtract from
     * @param {Number} bpToSubtract - number of bp to subtract
     */
    subtractBp(position, bpToSubtract) {
      if (bpToSubtract &lt;= position) {
        return position - bpToSubtract
      } else {
        return this.sequenceLength + position - bpToSubtract
      }
    }

    /**
     * Add *bpToAdd* to *position*, taking into account the sequenceLength
     * @param {Number} position - position (in bp) to add to
     * @param {Number} bpToAdd - number of bp to add
     */
    addBp(position, bpToAdd) {
      if (this.sequenceLength >= (bpToAdd + position)) {
        return bpToAdd + position
      } else {
        return position - this.sequenceLength + bpToAdd
      }
    }


    // Get mouse position in the 'container' taking into account the pixel ratio
    // mouse(container) {
    //   if (container == undefined) {
    //     container = self.canvas
    //   }
    //   return d3.mouse(container).map(function(p) { return CGV.pixel(p); });
    // }

    lengthOfRange(start, stop) {
      if (stop >= start) {
        return stop - start
      } else {
        return this.sequencelength + (stop - start)
      } 
    }


    toImage(width, height) {
      width = width || this.width;
      height = height || this.height;

      var windowTitle = 'CGV-Image-' + width + 'x' + height,

      // Adjust size based on pixel Ratio
      width = width / CGV.pixel_ratio;
      height = height / CGV.pixel_ratio;

      // Save current settings
      var orig_context = this.canvas.ctx;

      // Generate new context and scales
      var temp_canvas = d3.select('body').append('canvas')
        .attr('width', width).attr('height', height).node();

      CGV.scale_resolution(temp_canvas, CGV.pixel_ratio);
      this.canvas.ctx = temp_canvas.getContext('2d');

      this.canvas.width = width;
      this.canvas.height = height;
      this.canvas.refreshScales();
      this.width = width
      this.height = height
      this.backboneRadius = 0.4 * width;
      for (var i = 0, len = this._legends.length; i &lt; len; i++) {
        this._legends[i].refresh();
      }

      // Generate image
      this.draw_full();
      var image = temp_canvas.toDataURL();

      // Restore original settings
      this.canvas.width = width;
      this.canvas.height = height;
      this.canvas.refreshScales();
      this.canvas.ctx = orig_context;

      // Delete temp canvas
      d3.select(temp_canvas).remove();

      var win = window.open();
      var html = [
        '&lt;html>',
          '&lt;head>',
            '&lt;title>',
              windowTitle,
            '&lt;/title>',
          '&lt;/head>',
          '&lt;body>',
            '&lt;h2>Your CGView Image is Below&lt;/h2>',
            '&lt;p>To save, right click on the image and choose "Save Image As..."&lt;/p>',
            '&lt;img style="border: 1px solid grey" src="' + image +  '"/ >',
          '&lt;/body>',
        '&lt;html>'
      ].join('');
      win.document.write(html);
    }


  }

  CGV.Viewer = Viewer;

})(CGView);
</code></pre>
        </article>
    </section>






        

        <footer>
            Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Thu Dec 08 2016 09:41:11 GMT-0700 (MST)
        </footer>
    </div>
</div>
<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
<script src="scripts/main.js"></script>
</body>
</html>
