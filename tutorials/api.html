<!DOCTYPE html>
<html>
<head>
  <title>CGView: API</title>
  <meta charset="UTF-8">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/0.5.1/marked.min.js"></script>

  <!-- Prerequisites -->
  <!-- Local -->
  <link rel="stylesheet" href="styles/tutorial.css" />
  <script src='scripts/tutorial.js'></script>
</head>
<body>

  <div id='main' class='cgv-tutorial'>
		<div id='markdown-out'></div>
  </div>

<div id='markdown-in' style='display:none;'>

There are several operations that can be used to manipulate and access
the different types of records (e.g. features, tracks, etc) in CGView:
read, add, remove, update, and reorder.
While it is possible to change record properties directly, see
[Advantages of Update API](#advantages-of-update-api) to learn why
it is not recommended. The API operation descriptions below use Features and
Tracks for the examples. API details by record type are also provided.
All the examples use a Viewer instance: <em>cgv</em>.

### API Operations
- [Adding Records](#adding-records)
- [Removing Records](#removing-records)
- [Updating Records](#updating-records) ([Advantages of Update API](#advantages-of-update-api))
- [Reordering Records](#reordering-records)
- [Reading Records](#reading-records)

### API Details by Record Type
- [Features API](#features-api)
- [Tracks API](#tracks-api)


# API Operations

## Adding Records
Adding records is done through methods on the Viewer Instance (e.g.
addFeatures, addTracks, etc). Data can be added as a single object to create
one record on as an array of objects to create an array of records.
```js
// Add a single feature
featureData = {...};
cgv.addFeatures(featureData)
// => Feature

// Add a multiple features
featureData = [{...},{...}];
cgv.addFeatures(featureData)
// => [Feature, Feature]
```

The data object is passed directly to the record constructor. So the following
are similar, however, creating an object directly with the constructor does not
trigger events or add the action to the CGView History (see
[Advantages of Update API](#advantages-of-update-api)).
```js
featureData = {...};
// Create Feature with Add API
cgv.addFeatures(featureData)

// Create Feature directly (Not Recommended)
new CGV.Feature(cgv, featureData)
```

## Removing Records
```js
// records can be a single record or an array of records
cgv.removeRecords(record)
// OR
cgv.record.remove()
```

### Updating Records
```js
// records can be a single record or an array of records
// attributes is an object e.g. {property1: newValue1, property2: newValue2}
cgv.updateRecords(records, attributes)
// OR
cgv.record.update(attributes)
```

### Reordering Records
```js
cgv.moveRecord(oldIndex, newIndex)
// OR
cgv.record.move(newIndex);
```

### Reading Records
```js
cgv.records()
cgv.records(1)
cgv.records(name)
```

# API Details by Record Type
## Features
## Tracts
## Plots
## Settings
## LegendItems
## etc.

## TOC

## Accessing records
```js
// TODO: many examples
cgv.features()
```

## Advantages of Update API

Instead of using the Update API, you could change properties directly:
```js
// Not recommended but it's OK to use this method if the advantages below do not apply.
feature.start = 1234;
```

However there are several advantages of using the Update API:

- More than one property can be changed at once.
```js
feature.update({start: 1234, end: 2345});
```
- An error will be returned if the property does not exist.
```js
feature.update({strt: 1234});
// => Error: Feature does not contain a 'strt' property.
```
- The update methods trigger events (e.g. 'features-update') that can be used as hooks.
  (LINK FOR EVENTS)
```js
cgv.on('features-update', (features) => {
    const names = features.map( f => f.name );
    console.log(`The following features have been updated: ${names.join(', ')}`)
});
```
- In some cases multiple objects (e.g. features, tracks, etc) can be updated at once.
```js
// This will update all 3 features but only generate 1 'features-update' event.
cgv.updateFeatures([feature1, feature2, feature3], {type: 'CDS'});
```
- The update methods will also be added to the CGView History (LINK) and therefore
  can undone or redone.
```js
cgv.undo();
cgv.redo();
```

## Triggering Events

Update events can also be triggered without changing properties.
This can be useful if something beside the properties have changed (e.g. new features have been added to a track).
```js
feature.update();
// Same as
cgv.trigger('features-update');
```


</div>

<script>
  tutorialMarkdown(marked);
</script>

</html>
