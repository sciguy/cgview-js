<!DOCTYPE html>
<html>
<head>
  <title>CGView: API</title>
  <meta charset="UTF-8">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/0.5.1/marked.min.js"></script>

  <!-- Prerequisites -->
  <!-- Local -->
  <link rel="stylesheet" href="styles/tutorial.css" />
  <script src='scripts/tutorial.js'></script>
</head>
<body>

  <div id='main' class='cgv-tutorial'>
		<div id='markdown-out'></div>
  </div>

<div id='markdown-in' style='display:none;'>

There are several actions that can be used to manipulate and access
the different types of records (e.g. features, tracks, etc) in CGView:
read, add, remove, update, and reorder.
While it is possible to change record properties directly, see
[Advantages of Update API](#advantages-of-update-api) to learn why
it is not recommended. The API action descriptions below use Features and
Tracks for the examples. API details by record type are also provided.
All the examples use a Viewer instance: <em>cgv</em>.

### API Actions
- [Adding Records](#adding-records)
- [Removing Records](#removing-records)
- [Updating Records](#updating-records) ([Advantages of Update API](#advantages-of-update-api))
- [Reordering Records](#reordering-records)
- [Reading Records](#reading-records)

### API Details by Record Type
- [Features](#features-api)
- [Tracks](#tracks-api)
- [Bookmarks](#bookmarks-api)


# API Actions
NOT IMPLEMENTED: All the API actions (except read) can be provided with an optional
options object that will effect how the action is added to the History.
- groupID or bundleID: id used to group actions together
- name: name that will show up in History
- addToHistory: whether this action is added to History. This let us skip transient actions (e.g. color changes).

## Adding Records
Adding records is done through methods on the Viewer Instance (e.g.
addFeatures, addTracks, etc). Data can be added as a single object to create
one record on as an array of objects to create an array of records.
Adding one or more records will trigger a single event (e.g. features-add)
Each record type will have a list of attributes that can be set when creating
records or updating them.
```js
// Add a single feature
featureData = {...};
cgv.addFeatures(featureData);
// => Feature

// Add a multiple features
featureData = [{...},{...}];
cgv.addFeatures(featureData);
// => [Feature, Feature]
```

The data object is passed directly to the record constructor. So the following
are similar, however, creating an object directly with the constructor does not
trigger events or add the action to the CGView History (see
[Advantages of Update API](#advantages-of-update-api)).
```js
featureData = {...};
// Create Feature with Add API (Recommended)
cgv.addFeatures(featureData);

// Create Feature directly (Not Recommended)
new CGV.Feature(cgv, featureData);
```

## Removing Records
Removing records is done through methods on the Viewer Instance (e.g. removeFeatures)
or directly on the record. Removing records will trigger a single event (e.g. features-remove).
```js
// Remove a single record
feature = cgv.features(1);
cgv.removeFeatures(feature);
// OR
feature.remove();

// Remove multiple records
features = [feature_1, feature_2, features_3];
cgv.removeFeatures(features);
```

## Updating Records
Updating records is done through methods on the Viewer Instance (e.g. updateFeatures)
or directly on the record. Updaing records will trigger a single event (e.g. features-update).
The list of attributes that can be updated for a record are the same as for adding new records.
```js
// attributes is an object describing the properties to change
attributes = {type: 'CDS', legend: 'CDS'};

// Update a single record
feature = cgv.features(1);
cgv.updateRecords(feature, attributes);
// OR
cgv.feature.update(attributes);

// Update multiple records to have the same attributes
features = [feature_1, feature_2, features_3];
cgv.updateRecords(features, attributes);
```

## Advantages of Update API

Instead of using the Update API, you could change properties directly:
```js
// Not recommended but it's OK to use this method if the advantages below do not apply.
feature.start = 1234;
```

However, there are several advantages of using the Update API:

- More than one property can be changed at once.
```js
feature.update({start: 1234, end: 2345});
```
- An error will be returned if the property does not exist.
```js
feature.update({strt: 1234});
// => Error: Feature does not contain a 'strt' property.
```
- The update methods trigger events (e.g. 'features-update') that can be used as hooks.
  (LINK FOR EVENTS)
```js
cgv.on('features-update', (features) => {
    const names = features.map( f => f.name );
    console.log(`The following features have been updated: ${names.join(', ')}`)
});
```
- In some cases multiple objects (e.g. features, tracks, etc) can be updated at once.
```js
// This will update all 3 features but only generate 1 'features-update' event.
cgv.updateFeatures([feature1, feature2, feature3], {type: 'CDS'});
```
- The update methods will also be added to the CGView History (LINK) and therefore
  can undone or redone.
```js
cgv.undo();
cgv.redo();
```

## Reordering Records
For some records, the order is important (e.g. Tracks, Contigs, etc).
Changing the order is done through methods on the Viewer Instance (e.g. moveTracks)
or directly on the record. Moving records will trigger a move event (e.g. tracks-reordered).
CHECK NAMING...
INDEX COULD BE CONFUSING...

```js
track = cgv.tracks(1)
cgv.moveTrack(track.index, newIndex)
// OR
track.move(newIndex);
```

## Reading Records
Accessing records is done through methods on teh Viewer Instance.

```js
// Access all the features
viewer.features()
// Access the first feature
viewer.features(1)
// Access the first feature with the name 'my_feature'
viewer.features('my_feature')
```

## Triggering Events

Update events can also be triggered without changing properties.
This can be useful if something beside the properties have changed (e.g. new features have been added to a track).
```js
feature.update();
// Same as
cgv.trigger('features-update');
```

# API Details by Record Type

## Settings (General)

Action                                       | Viewer Method                                    | Settings Method                  | Event
---------------------------------------------|--------------------------------------------------|----------------------------------|-----
[Update](tutorial-api.html#updating-records) | -                                                | [update()](Settings.html#update) | settings-update

Attribute                          | Type      | Description
-----------------------------------|-----------|------------
[backgroundColor](Settings.html#backgroundColor) | String    | A string describing the background color of the map [Default: 'white']. See {@link Color} for details.
[showShading](Settings.html#showShading) | Boolean   | Should a shading effect be drawn on the features [Default: true]
[arrowHeadLength](Settings.html#arrowHeadLength) | Number    | Length of feature arrowheads as a proportion of the feature thickness. From 0 (no arrowhead) to 1 (arrowhead as long on the feature is thick) [Default: 0.3]

## Features API

Action                                       | Viewer Method                                  | Feature Method                  | Event
---------------------------------------------|------------------------------------------------|---------------------------------|-----
[Add](tutorial-api.html#adding-records)      | [addFeatures()](Viewer.html#addFeatures)       | -                               | features-add
[Update](tutorial-api.html#updating-records) | [updateFeatures()](Viewer.html#updateFeatures) | [update()](Feature.html#update) | features-update
[Remove](tutorial-api.html#removing-records) | [removeFeatures()](Viewer.html#removeFeatures) | [remove()](Feature.html#remove) | features-remove
[Read](tutorial-api.html#reading-records)    | [features()](Viewer.html#features)             | -                               | -

Attribute                      | Type     | Description
--------------------------------|----------|------------
[name](Feature.html#name)       | String   | Name of feature
[type](Feature.html#type)       | String   | Feature type (e.g. CDS, rRNA, etc)
[legend](Feature.html#legend)   | String\|LegendItem | Name of legendItem or the legendItem itself
[collection](Feature.html#collection) | String   | Collection the feature belongs to
[contig](Feature.html#contig)   | String\|Contig | Name of contig or the contig itself
[start](Feature.html#start)*   | Number   | Start base pair on the contig
[stop](Feature.html#stop)*     | Number   | Stop base pair on the contig
[strand](Feature.html#strand)   | String   | Strand the features is on [Default: 1]
[score](Feature.html#score)     | Number   | Score associated with the feature
[favorite](Feature.html#favorite) | Boolean  | Feature is a favorite [Default: false]
[visible](CGObject.html#visible) | Boolean  | Feature is visible [Default: true]
[meta](CGObject.html#meta)      | Object   | [Meta data](tutorial-meta.html) for Feature

*Required on Feature creation

## Tracks API

## Bookmarks API

Action                                       | Viewer Method                                    | Bookmark Method                  | Event
---------------------------------------------|--------------------------------------------------|----------------------------------|-----
[Add](tutorial-api.html#adding-records)      | [addBookmarks()](Viewer.html#addBookmarks)       | -                                | bookmarks-add
[Update](tutorial-api.html#updating-records) | [updateBookmarks()](Viewer.html#updateBookmarks) | [update()](Bookmark.html#update) | bookmarks-update
[Remove](tutorial-api.html#removing-records) | [removeBookmarks()](Viewer.html#removeBookmarks) | [remove()](Bookmark.html#remove) | bookmarks-remove
[Read](tutorial-api.html#reading-records)    | [bookmarks()](Viewer.html#bookmarks)             | -                                | -

Attribute                          | Type      | Description
-----------------------------------|-----------|------------
[name](Bookmark.html#name)         | String    | Name of bookmark [Default: "Bookmark-N" where N is the number of the bookmark]
[bp](Bookmark.html#bp)             | Number    | Base pair to center the map position [Default: Current bp]
[zoom](Bookmark.html#zoom)         | Number    | Zoom factor [Default: Current zoomFactor]
[format](Bookmark.html#format)     | String    | Map format [Default: Current map format]
[bbOffset](Bookmark.html#bbOffset) | Number    | Distance from the backbone to the center of the canvas [Default: 0]
[shortcut](Bookmark.html#shortcut) | Character | Single character shortcut that when pressed moves the map to this position [Default: N (see name) up to 9]
[favorite](Bookmark.html#favorite) | Boolean   | Bookmark is a favorite [Default: false]
[visible](CGObject.html#visible)   | Boolean   | Bookmark is visible [Default: true]
[meta](CGObject.html#meta)         | Object    | [Meta data](tutorial-meta.html) for Bookmark


## Captions API

Action                                       | Viewer Method                                    | Caption Method                  | Event
---------------------------------------------|--------------------------------------------------|----------------------------------|-----
[Add](tutorial-api.html#adding-records)      | [addCaptions()](Viewer.html#addCaptions)       | -                                | captions-add
[Update](tutorial-api.html#updating-records) | [updateCaptions()](Viewer.html#updateCaptions) | [update()](Caption.html#update) | captions-update
[Remove](tutorial-api.html#removing-records) | [removeCaptions()](Viewer.html#removeCaptions) | [remove()](Caption.html#remove) | captions-remove
[Reorder](tutorial-api.html#reordering-records) | [moveCaption()](Viewer.html#moveCaption) | [move()](Caption.html#move) | captions-reorder
[Read](tutorial-api.html#reading-records)    | [captions()](Viewer.html#captions)             | -                                | -

Attribute                          | Type      | Description
-----------------------------------|-----------|------------
[name](Caption.html#name)          | String    | Text of the caption
[position](Caption.html#position)  | String\|Object   | Where to draw the caption [Default: 'middle-center']. See {@link Position} for details.
[anchor](Caption.html#anchor)      | String\|Object   | Where to anchor the caption box to the position [Default: 'middle-center']. See {@link Anchor} for details.
[font](Caption.html#font)          | String    | A string describing the font [Default: 'SansSerif, plain, 8']. See {@link Font} for details.
[fontColor](Caption.html#fontColor) | String    | A string describing the color [Default: 'black']. See {@link Color} for details.
[textAlignment](Caption.html#textAlignment) | String    | Alignment of caption text: *left*, *center*, or *right* [Default: 'left']
[backgroundColor](Caption.html#font) | String    | A string describing the background color of the caption [Default: 'white']. See {@link Color} for details.
[on](Caption.html#on)**              | String    | Place the caption relative to the 'canvas' or 'map' [Default: 'canvas']
[visible](CGObject.html#visible)   | Boolean   | Caption is visible [Default: true]
[meta](CGObject.html#meta)         | Object    | [Meta data](tutorial-meta.html) for Caption

**Ignored on Caption creation

## Legend API

Action                                          | Viewer Method                                    | Legend Method                  | Event
------------------------------------------------|--------------------------------------------------|----------------------------------|-----
[Add](tutorial-api.html#adding-records)         | -                                                | -                                | legends-add
[Update](tutorial-api.html#updating-records)    | -                                                | [update()](Legend.html#update)   | legends-update

Attribute                          | Type      | Description
-----------------------------------|-----------|------------
[position](Legend.html#position)  | String\|Object   | Where to draw the legend [Default: 'top-right']. See {@link Position} for details.
[anchor](Legend.html#anchor)      | String\|Object   | Where to anchor the legend box to the position [Default: 'auto']. See {@link Anchor} for details.
[defaultFont](Legend.html#defaultFont)          | String    | A string describing the default font [Default: 'SansSerif, plain, 8']. See {@link Font} for details.
[defaultFontColor](Legend.html#defaultFontColor) | String    | A string describing the default font color [Default: 'black']. See {@link Color} for details.
[textAlignment](Legend.html#textAlignment) | String    | Alignment of legend text: *left*, *center*, or *right* [Default: 'left']
[backgroundColor](Legend.html#font) | String    | A string describing the background color of the legend [Default: 'white']. See {@link Color} for details.
[on](Legend.html#on)**              | String    | Place the legend relative to the 'canvas' or 'map' [Default: 'canvas']
[visible](CGObject.html#visible)   | Boolean   | Legend is visible [Default: true]
[items](Legend.html#items)***      | Array     | Array of legend item data.
[meta](CGObject.html#meta)         | Object    | [Meta data](tutorial-meta.html) for Legend

**Ignored on Legend creation
***Ignored on Legend update

## Legend Items

Action                                          | Viewer Method                                  | LegendItem Method                  | Event
------------------------------------------------|------------------------------------------------|------------------------------------|-----
[Add](tutorial-api.html#adding-records)         | [addItems()](Legend.html#addItems)             | -                                  | legendItems-add
[Update](tutorial-api.html#updating-records)    | [updateItems()](Legend.html#updateItems)       | [update()](LegendItem.html#update) | legendItems-update
[Remove](tutorial-api.html#removing-records)    | [removeLegendItems()](Legend.html#removeItems) | [remove()](LegendItem.html#remove) | legendItems-remove
[Reorder](tutorial-api.html#reordering-records) | [moveLegendItem()](Legend.html#moveItem)       | [move()](LegendItem.html#move)     | legendItems-reorder
[Read](tutorial-api.html#reading-records)       | [legendItems()](Legend.html#items)             | -                                  | -

Attribute                          | Type      | Description
-----------------------------------|-----------|------------
[name](LegendItem.html#name)         | String    | Name to diplay for legendItem 
[font](LegendItem.html#font)           | String    | A string describing the font [Default: 'SansSerif, plain, 8']. See {@link Font} for details.
[fontColor](LegendItem.html#fontColor) | String    | A string describing the font color [Default: 'black']. See {@link Color} for details.
[decoration](LegendItem.html#decoration) | String    | How the features should be drawn. Choices: 'arc' [Default], 'arrow', 'score', 'none' [Default: 'arc']
[swatchColor](LegendItem.html#swatchColor) | String    | A string describing the legendItem display color [Default: 'black']. See {@link Color} for details.
[drawSwatch](LegendItem.html#drawSwatch) | Boolean   | Draw the swatch beside the legendItem name [Default: true]
[favorite](LegendItem.html#favorite) | Boolean   | LegendItem is a favorite [Default: false]
[visible](CGObject.html#visible)   | Boolean   | LegendItem is visible [Default: true]
[meta](CGObject.html#meta)         | Object    | [Meta data](tutorial-meta.html) for LegendItem

## Annotation

Action                                       | Viewer Method                                    | Annotation Method                  | Event
---------------------------------------------|--------------------------------------------------|------------------------------------|-----
[Update](tutorial-api.html#updating-records) | -                                                | [update()](Annotation.html#update) | annotation-update
[Read](tutorial-api.html#reading-records)    | [annotation](Viewer.html#annotation)             | -                                  | -

Attribute                          | Type      | Description
-----------------------------------|-----------|------------
[font](Annotation.html#font)       | String    | A string describing the font [Default: 'sans-serif, plain, 12']. See {@link Font} for details.
[color](Annotation.html#color)     | String   | A string describing the color [Default: undefined]. If the color is undefined, the legend color for the feature will be used. See {@link Color} for details.
[onlyDrawFavorites](Annotation.html#onlyDrawFavorites) | Boolean   | Only draw labels for features that are favorited [Default: false]
[visible](CGObject.html#visible)   | Boolean   | Labels are visible [Default: true]
[meta](CGObject.html#meta)         | Object    | [Meta data](tutorial-meta.html) for Annotation

## Ruler

Action                                       | Viewer Method                                    | Ruler Method                  | Event
---------------------------------------------|--------------------------------------------------|-------------------------------|-----
[Update](tutorial-api.html#updating-records) | -                                                | [update()](Ruler.html#update) | ruler-update
[Read](tutorial-api.html#reading-records)    | [ruler](Viewer.html#ruler)                       | -                             | -

Attribute                          | Type      | Description
-----------------------------------|-----------|------------
[font](Ruler.html#font)            | String    | A string describing the font [Default: 'sans-serif, plain, 10']. See {@link Font} for details.
[color](Ruler.html#color)          | String    | A string describing the color [Default: 'black']. See {@link Color} for details.
[visible](CGObject.html#visible)   | Boolean   | Rulers are visible [Default: true]
[meta](CGObject.html#meta)         | Object    | [Meta data](tutorial-meta.html) for Ruler


## TEMPLATE

Action                                       | Viewer Method                                    | Record Method                  | Event
---------------------------------------------|--------------------------------------------------|----------------------------------|-----
[Add](tutorial-api.html#adding-records)      | [addRecords()](Viewer.html#addRecords)       | -                                | records-add
[Update](tutorial-api.html#updating-records) | [updateRecords()](Viewer.html#updateRecords) | [update()](Record.html#update) | records-update
[Remove](tutorial-api.html#removing-records) | [removeRecords()](Viewer.html#removeRecords) | [remove()](Record.html#remove) | records-remove
[Reorder](tutorial-api.html#reordering-records) | [moveRecord()](Viewer.html#moveRecord) | [move()](Record.html#move) | records-reorder
[Read](tutorial-api.html#reading-records)    | [records()](Viewer.html#records)             | -                                | -

Attribute                          | Type      | Description
-----------------------------------|-----------|------------
[name](Record.html#name)         | String    | Name of record [Default: "Record-N" where N is the number of the record]
[favorite](Record.html#favorite) | Boolean   | Record is a favorite [Default: false]
[visible](CGObject.html#visible)   | Boolean   | Record is visible [Default: true]
[meta](CGObject.html#meta)         | Object    | [Meta data](tutorial-meta.html) for Record

## Tracks
## Plots
## LegendItems
## etc.

</div>

<script>
  tutorialMarkdown(marked);
</script>

</html>
