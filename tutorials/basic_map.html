<!DOCTYPE html>
<html>
<head>
  <title>CGView: Basic Map</title>
  <meta charset="UTF-8">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/0.5.1/marked.min.js"></script>

  <!-- Prerequisites -->
  <!-- Local -->
  <!-- <script src="https://d3js.org/d3.v4.min.js"></script> -->
  <script src="../javascript/d3.v4.min.js"></script>
  <!-- CGView -->
  <script src='../src/CGView.js'></script>
  <link rel="stylesheet" href="../stylesheets/cgview.css" />
  <link rel="stylesheet" href="styles/tutorial.css" />
  <script src='scripts/tutorial.js'></script>
</head>
<body>

  <div id='main' class='cgv-tutorial'>
		<div id='markdown-out'></div>
		<div>
			<div id='my-viewer'></div>
		</div>
    <div id='final-code'>
		  <h2>Complete Code without Comments:</h2>
			<pre class='prettyprint'><code class='lang-js final'></code></pre></div>
  </div>

<div id='markdown-in' style='display:none;'>

CGView Maps consist of [features](Feature.html) and/or [plots](Plot.html). How the features
and plots are organized on the map is through the viewer [Layout](Layout.html).
The [Layout](Layout.html) consists of one or more [Tracks](Track.html) where each
[Track](Track.html) describes which features/plots it consists of and how they should be displayed.
[Tracks](Track.html) are drawn as one or more [Slots](Slot.html) on the map.
Each [Slot](Slot.html) represents a single ring on the map.
For example a [Track](Track.html) can draw [Features](Feature.html) separated by strand as two
[Slots](Slot.html) or combined as a single [Slot](Slot.html).

## Create a new [Viewer](Viewer.html) ##

The *Viewer* is the main object in CGView.js. While many options can be
provided when creating the viewer, the most important is the sequence option.
For the sequence, you can provide the length or the sequence itself. In this
example, we will simply use the length. See the [Sequence Map](sequence_map.html)
tutorial to see the benefits of using the sequence.

```js
// The first argument is the id of the container that will hold the viewer.
cgv = new CGV.Viewer('#my-viewer', {
  height: 500,
  width: 500,
  sequence: {
    // The length of the sequence
    length: 1000
  }
});
```

## Create a [Feature](Feature.html) on the forward strand. ##

```js
new CGV.Feature(cgv, {
  // Feature type. Used to determine how the feature is drawn (e.g. arrow or arc).
  // If a FeatureType with this name does not exist, a new FeatureType will be
  // created with this name and the default settings
  // (e.g. the decoration will be an 'arc').
  type: 'CDS',
  // Name of the feature.
  name: 'Feature',
  // Beginning of the feature in bp. Must be <= stop.
  start: 100,
  // End of the feature in bp. Must be >= start.
  stop: 250,
  // Which strand is the feature on. 1: forward strand; -1: reverse strand.
  strand: 1,
  // Used to group features into a track.
  source: 'genome-features',
  // Name of LegendItem to associate with the feature.
  // If a LegendItem with this text does not exist, a new LegendItem will be created
  // with this text and the default settings (e.g. the color will be 'black').
  legend: 'CDS'
});
```

## Create a [Feature](Feature.html) on the reverse strand. ##

```js
new CGV.Feature(cgv, {
  type: 'CDS',
  name: 'Another Feature',
  start: 400,
  stop: 750,
  strand: -1,
  source: 'genome-features',
  legend: 'CDS'
});
```

## Change the color and decoration of the Features
The [color](Color.html) and decoration of features is altered through the [LegendItem](LegendItem.html).
When a feature is created, the _legend_ attribute is used to find any
previously created [LegendItem](LegendItem.html) with the same name.
If no LegendItem is found, one will be created with the default settings.
Here we find the generated LegendItem and change it's color and decoration.

```js
// Find the legend item
var legendItem = cgv.legend.items('CDS');
// Change the color. The color can be a color name, RGB, or RGBA.
legendItem.color = 'green';
// Change the decoration. Options: 'arc', 'arrow', 'none'
legendItem.decoration = 'arrow';
```


## Create a [Plot](Plot.html). ##

Now we'll create a [plot](Plot.html). Plots consist of an array of positions (in bp) and a
matching array of scores with values between 0 and 1. An optional baseline can be provided (default 0.5).
Values above the baseline are positive and values below the baseline are negative.

```js

var plot = new CGV.Plot(cgv, {
  positions: [50, 200, 400, 500, 600, 800],
  scores: [0.4, 0.75, 0.25, 0.5, 0.6, 0.1],
  baseline: 0.5,
  source: 'genome-plot',
  // Values above the baseline wil be blue
  legendPositive: new CGV.LegendItem(cgv.legend, {swatchColor: 'blue', text: 'Plot +'}),
  // Values below will be red
  legendNegative: new CGV.LegendItem(cgv.legend, {swatchColor: 'red', text: 'Plot -'})
});
```


## Create a [Track](Track.html) for the features. ##

Each Track can contain one or more Features or a single Plot.

```js
// The first argument for a track is the viewer layout
new CGV.Track(cgv, {
  // Name for the track.
  name: 'My track',
  // Draw the track using separated or combined slots for each reading frame.
  // Options: 'separated', 'combined'.
  readingFrame: 'combined',
  // Draw the track using separated or combined slots for the forward and reverse strand.
  // Options: 'separated', 'combined'.
  strand: 'separated',
  // Where to draw the track in relation to the backbone.
  // Options: 'inside', 'outside', 'both'.
  position: 'both',
  // Here we describe what features or plot will be in the track.
  contents: {
    // Type of track. Options: 'feature', 'plot'
    // The type is set automatically when extracting from the sequence.
    type: 'feature',
    // From where to extract the features/plot. Options:
    //  - 'source'   : the source property of the features/plots will be used for selection
    //  - 'sequence' : the features/plot will be generated from the sequence
    from: 'source',
    // How to extract the features/plot.
    // For 'source', the extract value can be a single value or an array of values.
    // For 'sequence', the extract value can be one of the following:
    //   'orfs', 'start-stop-codons', 'gc-skew', 'gc-content'
    // e.g. In this example all features with a source of 'genome-features' will be used
    extract: 'genome-features'
  }
});
```

## Create a [Track](Track.html) for the plot. ##

```js
new CGV.Track(cgv, {
  // Name for the track.
  name: 'My Plot Track',
  // Note, that the readingFrame and strand options are ignores for plots.
  // Where to draw the track in relation to the backbone.
  // Options: 'inside', 'outside', 'both'.
  position: 'inside',
  // Here we describe what features or plot will be in the track.
  contents: {
    type: 'plot',
    from: 'source',
    // In this example the first plot with a source of 'genome-plot' will be used
    extract: 'genome-plot'
  }
});
```

## Draw the Map ##

```js
cgv.drawFull();
```

The resulting Viewer (id='my-viewer') is below. You can move the map around by clicking and dragging.
You can zoom, using your mouse scroll wheel. The Lenged colors can be changed by clicking on the swatches in the Legend.
If you want play around with the viewer object, open your browser web inspector. In the console, you can access the viewer as *cgv*.
</div>

<script>
  tutorialMarkdown(marked);
</script>

</html>
