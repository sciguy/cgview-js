<!DOCTYPE html>
<html>
<head>
  <title>CGView: Sequence Map</title>
  <meta charset="UTF-8">
  <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
  <!-- <script src="javascript/jquery&#45;1.11.1.min.js"></script> -->
  <!-- Bootstrap 3 -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
	<script src="../javascript/marked.min.js"></script>

	<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/styles/default.min.css">
	<script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/highlight.min.js"></script>
	<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
	<link rel="stylesheet" href="styles/prettify-jsdoc.css">
	<link rel="stylesheet" href="styles/prettify-tomorrow.css">
	<link rel="stylesheet" href="../stylesheets/tutorial.css">
	<!-- <link rel="stylesheet" href="docs/styles/jaguar.css"> -->

  <!-- Prerequisites -->
  <!-- Local -->
  <!-- <script src="https://d3js.org/d3.v4.min.js"></script> -->
  <script src="../javascript/d3.v4.min.js"></script>
  <script src="https://d3js.org/d3-selection-multi.v0.4.min.js"></script>
  <!-- CGView -->
  <script src='../src/CGView.js'></script>
  <link rel="stylesheet" href="../stylesheets/cgview.css" />
</head>
<body>

	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-nav" aria-expanded="false">
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="#">CGView.js</a>
			</div>
			<div class="collapse navbar-collapse" id="main-nav">
				<ul class="nav navbar-nav">
					<li><a href="../viewer.html">Demo</a></li>
					<li><a href="index.html">Docs</a></li>
					<li><a href="json_format.html">JSON</a></li>
          <li class="dropdown active">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Tutorials <span class="caret"></span></a>
            <ul class="dropdown-menu">
              <li><a href="basic_map.html">Basic Map</a></li>
              <li class='active'><a href="sequence_map.html">Sequence Map</a></li>
              <li><a href="json_map.html">JSON Map</a></li>
            </ul>
          </li>
				</ul>
			</div>
		</div>
	</div>

  <div id='main'>
		<div id='markdown-out'></div>
		<div>
			<div id='my-viewer'></div>
		</div>
    <div id='final-code'>
		  <h2>Complete Code without Comments:</h2>
			<pre class='prettyprint'><code class='lang-js final'></code></pre></div>
  </div>

<div id='markdown-in' style='display:none;'>

# Sequence Map #

Maps that have a sequence provided have two main benefits: 1) when zoomed in far enough
you will be able to see the sequence on the map; and 2) additional tracks can be easily
created with plots (e.g. GC Skew, GC Content) or features (e.g. start/stop codons, ORFs)
extracted from the directly from the sequence.

## Create a new [Viewer](Viewer.html) ##

In this example we will provide a random sequence using the [Sequence#random](Sequence.html#random) method.

```js
// The first argument is the id of the container that will hold the viewer.
cgv = new CGV.Viewer('#my-viewer', {
  height: 500,
  width: 500,
  sequence: {
    // Provide the sequence.
    seq: CGV.Sequence.random(10000)
  }
});
```

## Create a [Track](Track.html) with ORFs extracted from the seqeunce ##

```js
// The first argument for a track is the viewer layout
new CGV.Track(cgv.layout, {
  // Name for the track.
  name: 'ORFs',
  // Draw the track using separated or combined slots for each reading frame.
  // Options: 'separated', 'combined'.
  readingFrame: 'separated',
  // Draw the track using separated or combined slots for the forward and reverse strand.
  // Options: 'separated', 'combined'.
  strand: 'separated',
  // Where to draw the track in relation to the backbone.
  // Options: 'inside', 'outside', 'both'.
  position: 'both',
  // Here we describe what features or plot will be in the track.
  contents: {
    // Type of track. Options: 'feature', 'plot'
    // The type is set automatically when extracting from the sequence.
    type: 'feature',
    // From where to extract the features/plot. Options:
    //  - 'source'   : the source property of the features/plots will be used for selection
    //  - 'sequence' : the features/plot will be generated from the sequence
    from: 'sequence',
    // How to extract the features/plot.
    // For 'source', the extract value can be a single value or an array of values.
    // For 'sequence', the extract value can be one of the following:
    //   'orfs', 'start-stop-codons', 'gc-skew', 'gc-content'
    // e.g. In this example, the ORF features will be extracted from the seqeunce.
    extract: 'orfs',
    // Additional options may be passed to the extractor
    // The following are the default options
    options: {
      start: 'ATG',
      stop: 'TAA,TAG,TGA',
      minORFLength: 100
    }
  }
});
```

## Create a [Track](Track.html) with start/stop codons extracted from the seqeunce ##

```js
new CGV.Track(cgv.layout, {
  name: 'Start Stop Codons',
  readingFrame: 'separated',
  strand: 'separated',
  position: 'both',
  contents: {
    type: 'feature',
    from: 'sequence',
    // e.g. In this example, the start and stop codon features will be extracted from the seqeunce.
    extract: 'start-stop-codons',
    // The following are the default options
    options: {
      start: 'ATG',
      stop: 'TAA,TAG,TGA'
    }
  }
});
```

## Create a [Track](Track.html) with a GC Skew plot extracted from the seqeunce ##

```js
new CGV.Track(cgv.layout, {
  name: 'GC Skew',
  position: 'inside',
  contents: {
    type: 'feature',
    from: 'sequence',
    // e.g. In this example, GC Skew plot will be extracted from the seqeunce.
    extract: 'gc-skew',
    // By default, the step and window values are calculated based on the sequence length,
    // but they can be overridden here.
    options: {
      step: 1,
      window: 100
    }
  }
});
```

## Create a [Track](Track.html) with a GC Content plot extracted from the seqeunce ##

```js
new CGV.Track(cgv.layout, {
  name: 'GC Content',
  position: 'inside',
  contents: {
    type: 'feature',
    from: 'sequence',
    // e.g. In this example, GC Content plot will be extracted from the seqeunce.
    extract: 'gc-content',
    // By default, the step and window values are calculated based on the sequence length,
    // but they can be overridden here.
    options: {
      step: 1,
      window: 100
    }
  }
});
```

## TODO
* Have image of map and parts (e.g. track, slot, caption, ruler, etc)


## Draw the Map ##

```js
cgv.drawFull();
```

The resulting Viewer (id='my-viewer') is below. You can move the map around by clicking and dragging.
You can zoom, using your mouse scroll wheel. The Lenged colors can be changed by clicking on the swatches in the Legend.
If you want play around with the viewer object, open your browser web inspector. In the console, you can access the viewer as *cgv*.
</div>

<script>
	// Convert Markdown to HTML
  // https://github.com/chjj/marked
  //marked.setOptions({
  //  sanitize: true
  //});
	var marked_ = marked;
	var marked = function(text) {
			var tok = marked_.lexer(text);
			text = marked_.parser(tok);
			text = text.replace(/<pre>/ig, '<pre class="prettyprint">');
      text = text.replace(/&amp;gt;/g, '>');
      text = text.replace(/&amp;lt;/g, '<');
			return text;
		};
	$('#markdown-out').html( marked($('#markdown-in').html()) );

  // var code = '';
  $('code.lang-js:not(.final)').each( function(c) {
	  var code = $(this).html().replace(/\s*\/\/.*/g, '');
    code = code.replace('&lt;', '<');
    code = code.replace('&gt;', '>');
    // console.log(code);
    eval( code );
		$('#final-code code').append( code + "\n" );
  });

 


</script>

</html>
